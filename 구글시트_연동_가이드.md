# 구글 시트 자동 연동 설정 가이드

## 1단계: 구글 시트 준비

1. **<PIAAGIO25@GMAIL.COM>** 계정으로 로그인하세요.
2. 구글 드라이브(<https://drive.google.com)에> 접속합니다.
3. 기존 "특수차량 체크리스트.xlsx" 파일을 업로드합니다.
4. 업로드한 파일을 우클릭 → "Google 스프레드시트로 열기"를 선택합니다.

## 2단계: Google Apps Script 설정

1. 구글 시트를 연 상태에서 **확장 프로그램 → Apps Script**를 클릭합니다.
2. 기존 코드를 모두 삭제하고 아래 코드를 붙여넣습니다:

```javascript
function doPost(e) {
  try {
    const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
    const data = JSON.parse(e.postData.contents);
    
    // 새 행에 데이터 추가
    const row = [
      data.구분,
      data.일시,
      data.차량번호,
      data.차량모델,
      data.팀명,
      data.운행자,
      data.항목,
      data.상태,
      data.세부내용
    ];
    
    sheet.appendRow(row);
    
    return ContentService.createTextOutput(JSON.stringify({
      'status': 'success',
      'message': '데이터가 성공적으로 저장되었습니다.'
    })).setMimeType(ContentService.MimeType.JSON);
    
  } catch (error) {
    return ContentService.createTextOutput(JSON.stringify({
      'status': 'error',
      'message': error.toString()
    })).setMimeType(ContentService.MimeType.JSON);
  }
}
```

1. **저장** 버튼(💾)을 클릭합니다.
2. **배포 → 새 배포**를 클릭합니다.
3. 톱니바퀴 아이콘(⚙️) → **웹 앱**을 선택합니다.
4. 설정:
   - **설명**: "특수차량 체크리스트 자동 입력"
   - **다음 계정으로 실행**: 나
   - **액세스 권한**: 모든 사용자
5. **배포** 버튼을 클릭합니다.
6. **액세스 승인** → <PIAAGIO25@GMAIL.COM> 계정 선택 → **고급** → **안전하지 않은 페이지로 이동** → **허용**
7. **웹 앱 URL**을 복사합니다. (예: `https://script.google.com/macros/s/AKfycby.../exec`)

## 3단계: 앱에 URL 입력

1. 복사한 **웹 앱 URL**을 아래에 붙여넣으세요:

```
웹 앱 URL: ___________________________________________
```

1. 이 URL을 저에게 알려주시면, `app.js` 파일에 자동으로 설정해 드리겠습니다.

## 4단계: 테스트

설정 완료 후:

1. 차량 점검을 진행합니다.
2. "점검 완료 및 전송" 버튼을 클릭합니다.
3. 구글 시트에 자동으로 데이터가 입력됩니다!

## 엑셀 파일로 다운로드

구글 시트에서 **파일 → 다운로드 → Microsoft Excel(.xlsx)**을 선택하면 원본 양식과 동일한 엑셀 파일을 받을 수 있습니다.

---

**문제가 발생하면 말씀해 주세요!**
